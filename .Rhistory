library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
cia <- readr::read_csv('/Users/harrison/Desktop/Statistics/Projects/Project 1/Stats-Project-1/cia_factbook.csv') #Change this to your csv's directory
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
cia <- readr::read_csv('/Users/harrison/Desktop/Statistics/Projects/Project 1/Stats-Project-1/cia_factbook.csv') #Change this to your csv's directory
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
cia <- readr::read_csv('/Users/harrison/Desktop/Statistics/Projects/Project 1/Stats-Project-1/cia_factbook.csv') #Change this to your csv's directory
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
ggplot (data=cia, aes(x=internet_usage_proportion, y=life_exp_at_birth)) + geom_point(aes(color = continent,size=density)) + xlab('Internet users / population') + ylab('Life Expentancy at birth') + ggtitle('Figure 1')
life_exp <- cia$life_exp_at_birth
s <- sd(life_exp)
se <- s/sqrt(length(life_exp))
se
t <- 23.459 / se
t
df = length(life_exp) - 2
df
2*qt(t,df)
glimpse(cia)
ggplot (data=cia, aes(x=birth_rate, y=life_exp_at_birth)) + geom_point(aes(color = continent,size = density)) + xlab("Birth Rate - births per 1,000 people") + ylab("Life Expentancy At Birth")  + ggtitle('Figure 2')
ggplot (data=cia, aes(x=death_rate)) +
geom_histogram(bins = 30, aes(fill = continent)) +
geom_vline(xintercept = median(cia$death_rate), col=rgb(.2,.6,.9)) +
xlab("Death Rate - deaths per 1,000 people") +
ylab("Count")  + ggtitle('Figure 3')
ggplot (data=cia, aes(x=life_exp_at_birth)) +
geom_histogram(bins = 30, aes(color = death_rate, fill=continent)) +
geom_vline(xintercept = median(cia$life_exp_at_birth), col=rgb(.2,.6,.9)) +
xlab("Life Expectancy at Birth - years") +
ylab("Count") + ggtitle('Figure 4')
continentmembercounts <- cia %>%
group_by(continent) %>%
count()
groups <- cia %>%
group_by(continent) %>%
select(birth_rate) %>%
summarize(
birth_rate = mean(birth_rate)) %>%
mutate(
difference_from_mean = birth_rate - mean(cia$birth_rate)
)
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
summary(lm_mod)
obs_slope <- lm_mod %>%
tidy() %>%
filter(term == "internet_usage_proportion") %>%
dplyr::select(estimate) %>%
pull()
obs_slope
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope,
color = "#F05133") +
xlim(-30,30)
set.seed(34209)
perm_ci <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
generate(reps = 1000, type = "bootstrap") %>%
calculate(stat = "slope")
visualize(perm_ci)
alpha <- .05
#lower percentile cutoff
p_lower <- .025
#upper percentile cutoff
p_upper <- 1-(.025)
# Create a confidence interval of stat using quantiles
quantile(perm_ci$stat,c(p_lower,p_upper))
noafrica <- cia %>%
filter(continent != "Africa")
ggplot (data=noafrica, aes(x=internet_usage_proportion, y=life_exp_at_birth)) +
geom_point(aes(color = continent,size=density)) +
xlab('Internet users / population') +
ylab('Life Expentancy at birth') +
ggtitle('Figure 7 - Africa Excluded')
lm_mod_noafrica <- lm(life_exp_at_birth ~ internet_usage_proportion, data=noafrica)
summary(lm_mod_noafrica)
obs_slope_noafrica <- lm_mod_noafrica %>%
tidy() %>%
filter(term == "internet_usage_proportion") %>%
dplyr::select(estimate) %>%
pull()
obs_slope_noafrica
set.seed(1010)
perm_slope_noafrica <- noafrica %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope_noafrica, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope_noafrica,
color = "#F05133") +
xlim(-20,20)
set.seed(1010)
perm_slope_noafrica <- noafrica %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope_noafrica, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope_noafrica,
color = "#F05133") +
xlim(-20,20)
set.seed(34210)
perm_ci_noafrica <- noafrica %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
generate(reps = 1000, type = "bootstrap") %>%
calculate(stat = "slope")
visualize(perm_ci_noafrica)
alpha <- .05
#lower percentile cutoff
p_lower <- .025
#upper percentile cutoff
p_upper <- 1-(.025)
# Create a confidence interval of stat using quantiles
quantile(perm_ci_noafrica$stat,c(p_lower,p_upper))
install.packages(tidyverse)
library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
install.packages(tidyverse)
library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
install.packages('tidyverse')
library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
install.packages("tidyverse")
library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
ggplot (data=cia, aes(x=internet_usage_proportion, y=life_exp_at_birth)) + geom_point(aes(color = continent,size=density)) + xlab('Internet users / population') + ylab('Life Expentancy at birth') + ggtitle('Figure 1')
life_exp <- cia$life_exp_at_birth
s <- sd(life_exp)
se <- s/sqrt(length(life_exp))
se
t <- 23.459 / se
t
df = length(life_exp) - 2
df
2*qt(t,df)
glimpse(cia)
ggplot (data=cia, aes(x=birth_rate, y=life_exp_at_birth)) + geom_point(aes(color = continent,size = density)) + xlab("Birth Rate - births per 1,000 people") + ylab("Life Expentancy At Birth")  + ggtitle('Figure 2')
ggplot (data=cia, aes(x=death_rate)) +
geom_histogram(bins = 30, aes(fill = continent)) +
geom_vline(xintercept = median(cia$death_rate), col=rgb(.2,.6,.9)) +
xlab("Death Rate - deaths per 1,000 people") +
ylab("Count")  + ggtitle('Figure 3')
ggplot (data=cia, aes(x=life_exp_at_birth)) +
geom_histogram(bins = 30, aes(color = death_rate, fill=continent)) +
geom_vline(xintercept = median(cia$life_exp_at_birth), col=rgb(.2,.6,.9)) +
xlab("Life Expectancy at Birth - years") +
ylab("Count") + ggtitle('Figure 4')
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
summary(lm_mod)
obs_slope <- lm_mod %>%
tidy() %>%
filter(term == "internet_usage_proportion") %>%
dplyr::select(estimate) %>%
pull()
obs_slope
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
summary(lm_mod)
obs_slope <- lm_mod %>%
tidy() %>%
filter(term == "internet_usage_proportion") %>%
dplyr::select(estimate) %>%
pull()
obs_slope
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope,
color = "#F05133") +
xlim(-30,30)
set.seed(34209)
perm_ci <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
generate(reps = 1000, type = "bootstrap") %>%
calculate(stat = "slope")
visualize(perm_ci)
set.seed(34209)
perm_ci <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
generate(reps = 1000, type = "bootstrap") %>%
calculate(stat = "slope")
visualize(perm_ci)
alpha <- .05
#lower percentile cutoff
p_lower <- .025
#upper percentile cutoff
p_upper <- 1-(.025)
# Create a confidence interval of stat using quantiles
quantile(perm_ci$stat,c(p_lower,p_upper))
ggplot (data=noafrica, aes(x=internet_usage_proportion, y=life_exp_at_birth)) +
geom_point(aes(color = continent,size=density)) +
xlab('Internet users / population') +
ylab('Life Expentancy at birth') +
ggtitle('Figure 7 - Africa Excluded')
noafrica <- cia %>%
filter(continent != "Africa")
ggplot (data=noafrica, aes(x=internet_usage_proportion, y=life_exp_at_birth)) +
geom_point(aes(color = continent,size=density)) +
xlab('Internet users / population') +
ylab('Life Expentancy at birth') +
ggtitle('Figure 7 - Africa Excluded')
lm_mod_noafrica <- lm(life_exp_at_birth ~ internet_usage_proportion, data=noafrica)
summary(lm_mod_noafrica)
obs_slope_noafrica <- lm_mod_noafrica %>%
tidy() %>%
filter(term == "internet_usage_proportion") %>%
dplyr::select(estimate) %>%
pull()
obs_slope_noafrica
lm_mod_noafrica <- lm(life_exp_at_birth ~ internet_usage_proportion, data=noafrica)
summary(lm_mod_noafrica)
obs_slope_noafrica <- lm_mod_noafrica %>%
tidy() %>%
filter(term == "internet_usage_proportion") %>%
dplyr::select(estimate) %>%
pull()
obs_slope_noafrica
library(countrycode)
library(tidyverse)
library(countrycode)
install.packages(dplyr)
library(dplyr)
library(infer)
library(tidyverse)
library(countrycode)
install.packages(dplyr)
library(dplyr)
library(infer)
install.packages(dplyr)
library(tidyverse)
library(countrycode)
install.packages('dplyr')
library(dplyr)
library(infer)
install.packages("dplyr")
library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
lm_mod
lm_mod
lm_mod[0]
lm_mod[1]
lm_mod[2]
lm_mod[1]
lm_mod[1][1]
lm_mod[1][1][1]
lm_mod[1,1]
lm_mod[1]
lm_mod$coefficients[1]
lm_mod$coefficients[2]
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
summary(lm_mod)
lm_mod
obs_slope <- lm_mod$coefficients[2]
obs_slope
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope,
color = "#F05133") +
xlim(-30,30)
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = lm)mod$coefficients[2],
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = lm_mod$coefficients[2],
color = "#F05133") +
xlim(-30,30)
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
summary(lm_mod)
obs_slope <- lm_mod$coefficients[2]
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope,
color = "#F05133") +
xlim(-30,30)
lm_mod_noafrica <- lm(life_exp_at_birth ~ internet_usage_proportion, data=noafrica)
summary(lm_mod_noafrica)
obs_slope_noafrica <- lm_mod_noafrica$coefficients[2]
obs_slope_noafrica
set.seed(34209)
perm_ci <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
generate(reps = 1000, type = "bootstrap") %>%
calculate(stat = "slope")
visualize(perm_ci)
library(tidyverse)
library(countrycode)
library(dplyr)
library(infer)
cia <- readr::read_csv("https://raw.githubusercontent.com/nichollsharrisonj/Stats-Project-1/master/cia_factbook.csv")
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
cia <- readr::read_csv("https://raw.githubusercontent.com/nichollsharrisonj/Stats-Project-1/master/cia_factbook.csv")
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
ggplot (data=cia, aes(x=birth_rate, y=life_exp_at_birth)) + geom_point(aes(color = continent,size = density)) + xlab("Birth Rate - births per 1,000 people") + ylab("Life Expentancy At Birth")  + ggtitle('Figure 2')
ggplot (data=cia, aes(x=internet_usage_proportion)) +
geom_histogram(bins = 12, aes(fill = continent)) +
geom_vline(xintercept = median(cia$internet_usage_proportion), col=rgb(.2,.6,.9)) +
xlab("Internet Usage Proportion") +
ylab("Count")  + ggtitle('Figure 2')
cia <- readr::read_csv("https://raw.githubusercontent.com/nichollsharrisonj/Stats-Project-1/master/cia_factbook.csv")
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
ggplot (data=cia, aes(x=internet_usage_proportion, y=life_exp_at_birth)) + geom_point(aes(color = continent,size=density)) + xlab('Internet users / population') + ylab('Life Expentancy at birth') + ggtitle('Figure 1')
cia <- readr::read_csv("https://raw.githubusercontent.com/nichollsharrisonj/Stats-Project-1/master/cia_factbook.csv")
cia <- cia %>% mutate(
continent = countrycode(country,origin="country.name",destination="continent"),
density = (population/area),
internet_usage_proportion = internet_users/population
)
cia <- na.omit(cia) #OMIT ALL ROWS WITH ANY NA VALUES
obs_slope <- lm_mod$coefficients[2]
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
obs_slope <- lm_mod$coefficients[2]
summary(lm_mod)
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope,
color = "#F05133") +
xlim(-30,30)
set.seed(1009)
perm_slope <- cia %>%
specify(life_exp_at_birth ~ internet_usage_proportion) %>%
hypothesize(null = "independence") %>%
generate(reps = 1000, type = "permute") %>%
calculate(stat = "slope")
ggplot(data=perm_slope, aes(x=stat)) +
geom_histogram(bins=100) +
geom_vline(xintercept = obs_slope,
color = "#F05133") + ggtitle("Figure 5")
xlim(-30,30)
alpha <- .05
#lower percentile cutoff
p_lower <- .025
#upper percentile cutoff
p_upper <- 1-(.025)
# Create a confidence interval of stat using quantiles
quantile(perm_ci$stat,c(p_lower,p_upper))
alpha <- .05
#lower percentile cutoff
p_lower <- .025
#upper percentile cutoff
p_upper <- 1-(.025)
# Create a confidence interval of stat using quantiles
quantile(perm_ci_noafrica$stat,c(p_lower,p_upper))
library(gridExtra)
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
obs_slope <- lm_mod$coefficients[2]
summary(lm_mod)
mainplot <- ggplot(data=cia, aes(x=internet_usage_proportion, y=life_exp_at_birth)) + geom_point(aes(color = continent,size=density)) + xlab('Internet users / population') + ylab('Life Expentancy at birth') + ggtitle('Figure 1')
ggplot (data=cia, aes(x=internet_usage_proportion)) +
geom_histogram(bins = 12, aes(fill = continent)) +
geom_vline(xintercept = median(cia$internet_usage_proportion), col=rgb(.2,.6,.9)) +
xlab("Internet Usage Proportion") +
ylab("Count")  + ggtitle('Figure 2')
plot2 <- ggplot (data=cia, aes(x=internet_usage_proportion)) +
geom_histogram(bins = 12, aes(fill = continent)) +
geom_vline(xintercept = median(cia$internet_usage_proportion), col=rgb(.2,.6,.9)) +
xlab("Internet Usage Proportion") +
ylab("Count")  + ggtitle('Figure 2')
plot2 <- ggplot (data=cia, aes(x=internet_usage_proportion)) +
geom_histogram(bins = 12, aes(fill = continent)) +
geom_vline(xintercept = median(cia$internet_usage_proportion), col=rgb(.2,.6,.9)) +
xlab("Internet Usage Proportion") +
ylab("Count")  + ggtitle('Figure 2')
grid.arrange(mainplot, plot2, ncol=2)
ggplot (data=cia, aes(x=life_exp_at_birth)) +
geom_histogram(bins = 12, aes(color = death_rate, fill=continent)) +
geom_vline(xintercept = median(cia$life_exp_at_birth), col=rgb(.2,.6,.9)) +
xlab("Life Expectancy at Birth - years") +
ylab("Count") + ggtitle('Figure 3')
lm_mod <- lm(life_exp_at_birth ~ internet_usage_proportion, data = cia)
obs_slope <- lm_mod$coefficients[2]
summary(lm_mod)
lm_res_noafrica <- resid(lm_mod_noafrica)
lm_res_noafrica <- data.frame(resid = lm_res_noafrica)
lm_res_noafrica <- lm_res_noafrica %>% mutate(internet_usage_proportion = noafrica$internet_usage_proportion)
plot15 <- ggplot(data=lm_res_noafrica, aes(x=resid))
plot15 + geom_histogram(binwidth=1, color="black") +
xlab("Residuals") +  ylab("Frequency") + ggtitle("Figure 15: Histogram of Residuals with Africa Excluded")
lm_res_noafrica <- resid(lm_mod_noafrica)
lm_res_noafrica <- data.frame(resid = lm_res_noafrica)
lm_res_noafrica <- lm_res_noafrica %>% mutate(internet_usage_proportion = noafrica$internet_usage_proportion)
plot15 <- ggplot(data=lm_res_noafrica, aes(x=resid)) + geom_histogram(binwidth=1, color="black") +
xlab("Residuals") +  ylab("Frequency") + ggtitle("Figure 15: Histogram of Residuals with Africa Excluded")
plot16 <- ggplot(data=lm_res_noafrica, aes(x = internet_usage_proportion, y =resid)) + geom_point(size = 1.5) +
xlab("Internet Usage Proportion") +  ylab("Residual")  +
geom_hline(yintercept=0, linetype='dashed', col = 'red') +
ggtitle("Figure 16: Internet Usage Proportion vs Residuals with Africa Excluded")
lm_res <- resid(lm_mod)
lm_res <- data.frame(resid = lm_res)
lm_res <- lm_res %>% mutate(internet_usage_proportion = cia$internet_usage_proportion)
plot6 <- ggplot(data=lm_res, aes(x=resid))+ geom_histogram(binwidth=1, color="black") +
xlab("Residuals") +
ylab("Frequency") +
ggtitle("Figure 6: Histogram of Residuals")
lm_res <- resid(lm_mod)
lm_res <- data.frame(resid = lm_res)
lm_res <- lm_res %>% mutate(internet_usage_proportion = cia$internet_usage_proportion)
plot6 <- ggplot(data=lm_res, aes(x=resid))+
geom_histogram(binwidth=1, color="black") +
xlab("Residuals") +
ylab("Frequency") +
ggtitle("Figure 6: Histogram of Residuals")
plot2 <- ggplot (data=cia, aes(x=internet_usage_proportion)) +
geom_histogram(bins = 12, aes(fill = continent)) +
geom_vline(xintercept = median(cia$internet_usage_proportion), col=rgb(.2,.6,.9)) +
xlab("Internet Usage Proportion") +
ylab("Count")  + ggtitle('Figure 2')
plot2
plot3
plot2
plot3
plot3 <- ggplot (data=cia, aes(x=life_exp_at_birth)) +
geom_histogram(bins = 12, aes(color = death_rate, fill=continent)) +
geom_vline(xintercept = median(cia$life_exp_at_birth), col=rgb(.2,.6,.9)) +
xlab("Life Expectancy at Birth - years") +
ylab("Count") + ggtitle('Figure 3')
plot2
plot3
grid.arrange(plot1, plot10, ncol=2)
plot2
plot3
grid.arrange(plot1, plot10, ncol=2)
plot2
plot3
grid.arrange(plot1, plot10, ncol=2)
plot4
